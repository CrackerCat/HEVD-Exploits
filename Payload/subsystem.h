#include <ntifs.h>
#include <ntddk.h>

PDEVICE_OBJECT pgDeviceObject;
UNICODE_STRING gDev, gDos;

#define PREFIX "[Payload] "

#define IOCTL_TEST CTL_CODE(FILE_DEVICE_UNKNOWN, 0, METHOD_NEITHER, FILE_ANY_ACCESS)

#define WINDOWS_10_21H2_X64_TOKEN_OFFSET 0x4B8

NTSTATUS PayloadExecuteLPE();
NTSTATUS PayloadDriverUnload(PDRIVER_OBJECT pDriverObject);
NTSTATUS PayloadCreateCloseIrp(PDEVICE_OBJECT pDeviceObject, PIRP Irp);
NTSTATUS PayloadDeviceIOControl(PDEVICE_OBJECT pDeviceObject, PIRP Irp);
NTSTATUS DriverEntry(PDRIVER_OBJECT pDriverObject, PUNICODE_STRING pRegistryPath);